{"version":3,"file":"app.js","sources":["../keet/src/components/ternaryOps.js","../keet/src/components/strInterpreter.js","../keet/src/components/templateParse/updateState.js","../keet/src/components/templateParse/valAssign.js","../keet/src/components/templateParse/replaceHandleBars.js","../keet/utils.js","../keet/src/components/genModelTemplate.js","../keet/src/components/genModelList.js","../keet/src/components/conditionalNodes.js","../keet/src/components/componentParse.js","../keet/src/components/templateParse/replaceCommentBlock.js","../keet/src/components/templateParse/addEvent.js","../keet/src/components/templateParse/index.js","../keet/node_modules/set-dom/src/parse-html.js","../keet/node_modules/set-dom/src/index.js","../keet/src/components/genElement.js","../keet/src/components/parseStr.js","../keet/src/base/mount.js","../keet/keet.js","../src/app/util.js","../src/app/filter-model.js","../src/app/filter.js","../src/app/todo-model.js","../src/app/todo.js","../src/app/app.js"],"sourcesContent":["// function to resolve ternary operation\r\n\r\nconst test = str => str === '\\'\\'' || str === '\"\"' || str === 'null' ? '' : str\r\n\r\nexport default function (input) {\r\n  if (input.match(/([^?]*)\\?([^:]*):([^;]*)|(\\s*=\\s*)[^;]*/g)) {\r\n    let t = input.split('?')\r\n    let condition = t[0]\r\n    let leftHand = t[1].split(':')[0]\r\n    let rightHand = t[1].split(':')[1]\r\n\r\n    // check the condition fulfillment\r\n\r\n    if(this){\r\n      if (this[condition]) {\r\n        return {\r\n          value: test(leftHand),\r\n          state: condition\r\n        }\r\n      } else {\r\n        return {\r\n          value: test(rightHand),\r\n          state: condition\r\n        }\r\n      }  \r\n    }\r\n    return false\r\n  } else return false\r\n}\r\n","export default (str) => {\r\n  let res = str.match(/\\.*\\./g)\r\n  let result\r\n  if (res && res.length > 0) {\r\n    return str.split('.')\r\n  }\r\n  return result\r\n}\r\n","export default function (state, updateStateList) {\r\n  if (typeof updateStateList === 'function') updateStateList(state)\r\n}\n","export default function (node, value, replace, withTo) {\r\n  value = value.replace(replace, withTo)\r\n  if (node) node.nodeValue = value\r\n}\n","import ternaryOps from '../ternaryOps'\r\nimport strInterpreter from '../strInterpreter'\r\nimport updateState from './updateState'\r\nimport valAssign from './valAssign'\r\n\r\nconst re = /{{([^{}]+)}}/g\r\n\r\nexport default function (value, node, ins, updateStateList, templateParse, isAttr) {\r\n  const props = value.match(re)\r\n  let ln = props.length\r\n  let rep\r\n  let tnr\r\n  let isObjectNotation\r\n  while (ln) {\r\n    ln--\r\n    rep = props[ln].replace(re, '$1')\r\n    tnr = ternaryOps.call(ins, rep)\r\n    isObjectNotation = strInterpreter(rep)\r\n    if (isObjectNotation) {\r\n      updateState(rep, updateStateList)\r\n      valAssign(node, value, '{{' + rep + '}}', ins[isObjectNotation[0]][isObjectNotation[1]])\r\n    } else {\r\n      if (tnr) {\r\n        updateState(tnr.state, updateStateList)\r\n        if (!isAttr) {\r\n          valAssign(node, value, '{{' + rep + '}}', tnr.value)\r\n        } else {\r\n          return tnr.value\r\n        }\r\n      } else {\r\n        if (ins[rep] !== undefined) {\r\n          updateState(rep, updateStateList)\r\n          if (!isAttr) {\r\n            valAssign(node, value, '{{' + rep + '}}', ins[rep])\r\n          } else {\r\n            return ins[rep]\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n","const genId = () => {\r\n  const rd = () => (Math.random()* 1*1e17).toString(36)\r\n  return `KDATA-${rd()}-${rd()}`\r\n}\r\n\r\nconst minId = () => (Math.random()* 1*1e17).toString(36)\r\n\r\nconst getId = id => document.getElementById(id)\r\n\r\n/**\r\n * @private\r\n * @description\r\n * Check a node availability in 100ms, if not found silenty skip the event\r\n * or execute a callback\r\n *\r\n * @param {string} id - the node id\r\n * @param {function} callback - the function to execute on success\r\n * @param {function} notFound - the function to execute on failed\r\n */\r\nconst checkNodeAvailability = (component, componentName, callback, notFound) => {\r\n  let ele = getId(component.el)\r\n  let found = false\r\n  let t\r\n  function find() {\r\n    ele = getId(component.el)\r\n    if (ele) {\r\n      clearInterval(t)\r\n      found = true\r\n      callback(component, componentName, ele)\r\n    }\r\n  }\r\n  function fail() {\r\n    clearInterval(t)\r\n    if (!found && notFound && typeof notFound === 'function') notFound()\r\n  }\r\n  if (ele) return ele\r\n  else {\r\n    t = setInterval(find, 0)\r\n    // ignore finding the node after sometimes\r\n    setTimeout(fail, 5)\r\n  }\r\n}\r\n\r\n/**\r\n * @private\r\n * @description\r\n * Confirm that a value is truthy, throws an error message otherwise.\r\n *\r\n * @param {*} val - the val to test.\r\n * @param {string} msg - the error message on failure.\r\n * @throws {Error}\r\n */\r\nconst assert = (val, msg) => {\r\n  if (!val) throw new Error('(keet) ' + msg)\r\n}\r\n\r\n/**\r\n * @private\r\n * @description\r\n * Simple html template literals MODIFIED from : http://2ality.com/2015/01/template-strings-html.html\r\n * by Dr. Axel Rauschmayer\r\n * no checking for wrapping in root element\r\n * no strict checking\r\n * remove spacing / indentation\r\n * keep all spacing within html tags\r\n * include handling ${} in the literals\r\n */\r\nconst html = (...args) => {\r\n  const literals = args.shift()\r\n  const substs = args.slice()\r\n\r\n  let result = literals.raw.reduce((acc, lit, i) => acc + substs[i - 1] + lit)\r\n  // remove spacing, indentation from every line\r\n  result = result.split(/\\n+/)\r\n  result = result.map(t => t.trim()).join('')\r\n  return result\r\n}\r\n\r\nconst notEqual = function(a, b){\r\n  return a['kdata-id'] !== b['kdata-id']\r\n}\r\n\r\nconst inform = function(model){\r\n  this.exec && typeof this.exec === 'function' && this.exec(model)\r\n}\r\n\r\n/**\r\n * @private\r\n * @description\r\n * Copy with modification from preact-todomvc. Model constructor with\r\n * registering callback listener in Object.defineProperty. Any modification\r\n * to ```this.list``` instance will subsequently inform all registered listener.\r\n *\r\n * {{model:<myModel>}}<myModelTemplateString>{{/model:<myModel>}}\r\n *\r\n */\r\nclass createModel {\r\n  constructor () {\r\n    this.model = []\r\n    this.exec = null\r\n\r\n    /**\r\n     * @private\r\n     * @description\r\n     * Register callback listener of any changes\r\n     */\r\n    Object.defineProperty(this, 'list', {\r\n      enumerable: false,\r\n      configurable: true,\r\n      get: function () {\r\n        return this.model\r\n      },\r\n      set: function (val) {\r\n        this.model = val\r\n        inform.call(this, this.model)\r\n      }\r\n    })\r\n  }\r\n\r\n  /**\r\n * @private\r\n * @description\r\n * Subscribe to the model changes (add/update/destroy)\r\n *\r\n * @param {Object} model - the model including all prototypes\r\n *\r\n */\r\n  subscribe (fn) {\r\n    this.exec = fn\r\n  }\r\n\r\n  /**\r\n * @private\r\n * @description\r\n * Add new object to the model list\r\n *\r\n * @param {Object} obj - new object to add into the model list\r\n *\r\n */\r\n  add (obj) {\r\n    this.list = this.list.concat({ ...obj, 'kdata-id': minId() })\r\n  }\r\n\r\n  /**\r\n * @private\r\n * @description\r\n * Update existing object in the model list\r\n *\r\n * @param {String} lookupId - lookup id property name of the object\r\n * @param {Object} updateObj - the updated properties\r\n *\r\n */\r\n  // update (lookupId, updateObj) {\r\n  //   this.list = this.list.map(obj =>\r\n  //     obj[lookupId] !== updateObj[lookupId] ? obj : Object.assign(obj, updateObj)\r\n  //   )\r\n  // }\r\n  update (updateObj) {\r\n    this.list = this.list.map(obj =>\r\n      notEqual(obj, updateObj) ? obj : updateObj\r\n     // ( obj !== updateObj ? obj : updateObj)\r\n    )\r\n  }\r\n  // this.todos = this.todos.map( todo => (\r\n  //     todo !== todoToToggle ? todo : ({ ...todo, completed: !todo.completed })\r\n  //   ) );\r\n  /**\r\n * @private\r\n * @description\r\n * Removed existing object in the model list\r\n *\r\n * @param {String} lookupId - lookup id property name of the object\r\n * @param {String} objId - unique identifier of the lookup id\r\n *\r\n */\r\n  destroy (destroyObj) {\r\n    this.list = this.list.filter(obj =>\r\n      notEqual(obj, destroyObj)\r\n    )\r\n  }\r\n  // destroy (lookupId, objId) {\r\n  //   this.list = this.list.filter(obj =>\r\n  //     obj[lookupId] !== objId\r\n  //   )\r\n  // }\r\n}\r\n\r\nexport {\r\n  createModel,\r\n  html,\r\n  assert,\r\n  checkNodeAvailability,\r\n  genId,\r\n  getId\r\n}\r\n","import ternaryOps from './ternaryOps'\r\n\r\nconst re = new RegExp(/(\\schecked=\")(.*?)(?=\")/g)\r\n\r\nlet tmpl = ''\r\nlet rep\r\nlet isTernary\r\nlet i\r\nlet len\r\nlet match\r\n\r\nexport default (string, obj) => {\r\n  const arrProps = string.match(/{{([^{}]+)}}/g)\r\n  tmpl = string\r\n  for (i = 0, len = arrProps.length; i < len; i++) {\r\n    rep = arrProps[i].replace(/{{([^{}]+)}}/g, '$1')\r\n    isTernary = ternaryOps.call(obj, rep)\r\n    if (isTernary) {\r\n      tmpl = tmpl.replace('{{' + rep + '}}', isTernary.value)\r\n    } else {\r\n      tmpl = tmpl.replace('{{' + rep + '}}', obj[rep])\r\n    }\r\n\r\n    match = tmpl.match(re)\r\n    if (match) {\r\n      if (match[0].length === 17) { tmpl = tmpl.replace(' checked=\"checked\"', ' checked') } else { tmpl = tmpl.replace(' checked=\"\"', '') }\r\n    }\r\n  }\r\n  return tmpl\r\n}\r\n","import { assert, getId, checkNodeAvailability } from '../../utils'\r\nimport genModelTemplate from './genModelTemplate'\r\nconst DOCUMENT_ELEMENT_TYPE = 1\r\nconst re = /{{([^{}]+)}}/g\r\n\r\n// diffing two array of objects, including object properties differences\r\nconst diff = (fst, sec) =>\r\n  fst.filter(obj =>\r\n    !sec.some(inr => {\r\n      let predicate = true\r\n      for (let attr in inr) {\r\n        if (obj[attr] !== inr[attr]) {\r\n          predicate = false\r\n        }\r\n      }\r\n      return predicate\r\n    })\r\n  )\r\n\r\n// check if browser support createRange\r\nlet range\r\nif (typeof document.createRange === 'function') {\r\n  range = document.createRange()\r\n}\r\n\r\n// storage for model state\r\nlet cache = {}\r\n\r\nlet m\r\nlet documentFragment\r\nfunction render(str, obj){\r\n  m = genModelTemplate(str, obj)\r\n  documentFragment = range.createContextualFragment(m)\r\n  documentFragment.firstChild.setAttribute('kdata-id', obj['kdata-id'])\r\n}\r\n\r\nexport default function (node, model, tmplHandler) {\r\n  // console.time('uu')\r\n  let modelList\r\n  let mLength\r\n  let i\r\n  let listClone\r\n  let parentNode\r\n  let updateOfNew\r\n  let diffOfOld\r\n  let pNode\r\n  let ref\r\n  let equalLength\r\n  let child\r\n  let list\r\n  let str\r\n  let oldModel\r\n  let p\r\n\r\n  cache[model] = cache[model] || {}\r\n\r\n  if (!cache[model].list) {\r\n    cache[model].list = node.nextSibling.cloneNode(true)\r\n  }\r\n  list = cache[model].list\r\n\r\n  if (!cache[model].str) {\r\n    cache[model].str = node.nextSibling.cloneNode(true).outerHTML\r\n    // remove the first prototype node\r\n    node.nextSibling.remove()\r\n     // also remove from pristine node\r\n    p = this.__pristineFragment__.getElementById(node.parentNode.id)\r\n    if(p) p.childNodes[1].remove()\r\n\r\n  }\r\n  str = cache[model].str\r\n\r\n  if (this[model] !== undefined && this[model].hasOwnProperty('list')) {\r\n    parentNode = node.parentNode\r\n\r\n    if (range && !parentNode.hasAttribute('data-ignore')) {\r\n      parentNode.setAttribute('data-ignore', '')\r\n    }\r\n\r\n    modelList = this[model].list\r\n\r\n    oldModel = cache[model].oldModel || []\r\n\r\n    // check if current browser doesn't support createRange()\r\n    if (!range) {\r\n      i = 0\r\n      while (i < modelList.length) {\r\n        // fallback to regular node generation handler\r\n        listClone = list.cloneNode(true)\r\n        tmplHandler(this, null, listClone, modelList[i])\r\n        listClone.setAttribute('kdata-id', modelList[i]['kdata-id'])\r\n        parentNode.insertBefore(listClone, null)\r\n        i++\r\n      }\r\n    } else {\r\n      updateOfNew = diff(modelList, oldModel)\r\n      diffOfOld = diff(oldModel, modelList)\r\n\r\n      const diffModel = function (...args) {\r\n        pNode = args.pop()\r\n        // check if both models are equally in length\r\n        equalLength = oldModel.length === modelList.length\r\n\r\n        // do properties update\r\n        if (equalLength) {\r\n          // console.log( new Date() - window.t)\r\n          // console.time('u')\r\n          i = 0\r\n          while(i < updateOfNew.length){\r\n            child = pNode.querySelector(`[kdata-id=\"${updateOfNew[i]['kdata-id']}\"]`)\r\n            render(str, updateOfNew[i])\r\n            pNode.replaceChild(documentFragment, child)\r\n            i++\r\n          }\r\n          // console.timeEnd('u')\r\n        // add new objects\r\n        } else if (updateOfNew.length > 0 && diffOfOld.length === 0) {\r\n          i = 0\r\n          while(i < updateOfNew.length){\r\n            render(str, updateOfNew[i])\r\n            pNode.insertBefore(documentFragment, pNode.lastChild)\r\n            i++\r\n          }\r\n        // destroy selected objects\r\n        } else if (updateOfNew.length === 0 && diffOfOld.length > 0) {\r\n          i = 0\r\n          while(i < diffOfOld.length){\r\n            child = pNode.querySelector(`[kdata-id=\"${diffOfOld[i]['kdata-id']}\"]`)\r\n            pNode.removeChild(child)\r\n            i++\r\n          }\r\n        }\r\n        // replace oldModel after diffing\r\n        cache[model].oldModel = JSON.parse(JSON.stringify(modelList))\r\n      }\r\n\r\n      // check existing parentNode in the DOM\r\n      if (parentNode.hasAttribute('id')) {\r\n        pNode = getId(parentNode.id)\r\n\r\n        if (pNode) {\r\n          diffModel.call(this, null, null, pNode)\r\n        } else {\r\n          checkNodeAvailability({ el: parentNode.id }, model, diffModel.bind(this), function () {\r\n            // we cleanup cache on failed search\r\n            cache[model].oldModel = []\r\n          })\r\n        }\r\n      }\r\n    }\r\n  } else {\r\n    assert(false, 'Model \"' + model + '\" does not exist.')\r\n  }\r\n  // console.timeEnd('uu')\r\n}\r\n","const conditionalNodesRawStart = /\\{\\{\\?([^{}]+)\\}\\}/g\r\nconst conditionalNodesRawEnd = /\\{\\{\\/([^{}]+)\\}\\}/g\r\nconst DOCUMENT_ELEMENT_TYPE = 1\r\nexport default function (node, conditional, tmplHandler) {\r\n  const frag = document.createDocumentFragment()\r\n  let entryNode\r\n  let currentNode\r\n  let isGen\r\n  let cNode\r\n  while (node) {\r\n    currentNode = node\r\n    node = node.nextSibling\r\n    if (currentNode.nodeType !== DOCUMENT_ELEMENT_TYPE) {\r\n      if (currentNode.nodeValue.match(conditionalNodesRawStart)) {\r\n        entryNode = currentNode\r\n      } else if (currentNode.nodeValue.match(conditionalNodesRawEnd)) {\r\n        // currentNode.remove()\r\n        // star generating the conditional nodes range, if not yet\r\n        if (!isGen) {\r\n          isGen = true\r\n          tmplHandler(this, null, null, null, frag)\r\n        }\r\n        if (this[conditional]) {\r\n          entryNode.parentNode.insertBefore(frag, entryNode)\r\n        }\r\n        // entryNode.remove()\r\n        node = null\r\n      }\r\n    } else {\r\n      cNode = currentNode.cloneNode(true)\r\n      frag.appendChild(cNode)\r\n      currentNode.remove()\r\n    }\r\n  }\r\n}\r\n","import { assert, getId } from '../../utils'\r\n\r\nlet cacheInit = {}\r\n\r\nexport default function (componentStr, node) {\r\n  const component = componentStr.replace('component:', '')\r\n  const c = this[component]\r\n\r\n  if (c !== undefined) {\r\n    // this is for initial component runner\r\n    if (!cacheInit[c.ID]) {\r\n      c.render.call(c, true)\r\n      cacheInit[c.ID] = c.base.cloneNode(true)\r\n      node.parentNode.replaceChild(c.base, node)\r\n    } else {\r\n      // we need to reattach event listeners if the node is not available on DOM\r\n      if (!getId(this[component].el)) {\r\n        c.base = c.__pristineFragment__.cloneNode(true)\r\n        c.render.call(c, true)\r\n        node.parentNode.replaceChild(c.base, node)\r\n      } else {\r\n        node.parentNode.replaceChild(cacheInit[c.ID].cloneNode(true), node)\r\n      }\r\n    }\r\n    // inform sub-component to update\r\n    c.callBatchPoolUpdate()\r\n  } else {\r\n    assert(false, 'Component ' + component + ' does not exist.')\r\n  }\r\n}\r\n","import genModelList from '../genModelList'\r\nimport conditionalNodes from '../conditionalNodes'\r\nimport updateState from './updateState'\r\nimport componentParse from '../componentParse'\r\n\r\nconst re = /{{([^{}]+)}}/g\r\nconst model = /^model:/g\r\nconst conditionalRe = /^\\?/g\r\nconst component = /^component:([^{}]+)/g\r\n\r\nexport default function (value, node, ins, updateStateList, templateParse) {\r\n  let conditionalRep\r\n  let rep\r\n  let modelRep\r\n  if (value.match(re)) {\r\n    rep = value.replace(re, '$1').trim()\r\n    if (rep.match(model)) {\r\n      modelRep = rep.replace('model:', '')\r\n      genModelList.call(this, node, modelRep, templateParse)\r\n    } else if (rep.match(conditionalRe)) {\r\n      conditionalRep = rep.replace('?', '')\r\n      if (ins[conditionalRep] !== undefined) {\r\n        updateState(conditionalRep, updateStateList)\r\n        conditionalNodes.call(this, node, conditionalRep, templateParse)\r\n      }\r\n    } else if (rep.match(component)) {\r\n      componentParse.call(this, rep, node)\r\n    }\r\n  }\r\n}\r\n","import { getId } from '../../../utils'\r\n\r\nconst DOCUMENT_ELEMENT_TYPE = 1\r\n\r\nconst re = /{{([^{}]+)}}/g\r\nconst modelRaw = /\\{\\{model:([^{}]+)\\}\\}/g\r\n\r\nconst lookUpEvtNode = node =>\r\n    !!(node.hasAttribute('id') && getId(node.id) && node.hasAttribute('evt-node'))\r\n\r\nfunction lookupParentNode(rootNode, node){\r\n  let cNode\r\n  while(node){\r\n    cNode = node\r\n    node = node.parentNode\r\n    if(cNode.nodeType === DOCUMENT_ELEMENT_TYPE && cNode.hasAttribute('kdata-id')){\r\n      return cNode.getAttribute('kdata-id')\r\n    }\r\n    if(cNode.isEqualNode(rootNode)){\r\n      node = null\r\n    }\r\n  }\r\n}\r\n\r\nlet nodeAttributes\r\nlet i = 0\r\nlet a\r\nlet ns\r\nlet evtName\r\nlet c\r\nlet h\r\nlet handlerArgs\r\nlet argv\r\nlet handler\r\nlet fn\r\nlet name\r\nlet p\r\nlet model\r\nlet rep\r\nlet t\r\n\r\nconst getIndex = id => model.list.map(m => m['kdata-id']).indexOf(id)\r\n\r\nexport default function (node) {\r\n\r\n  nodeAttributes = node.attributes\r\n  if (lookUpEvtNode(node)) {\r\n    // skip addding event for node that already has event\r\n    // to allow skipping adding event the node must include `id`/\r\n  } else {\r\n    // only add event when node does not has one\r\n    for (i = nodeAttributes.length; i--;) {\r\n      a = nodeAttributes[i]\r\n      name = a.localName\r\n      ns = a.nodeValue\r\n      if (/^k-/.test(name)) {\r\n        evtName = name.replace(/^k-/, '')\r\n        handler = ns.match(/[a-zA-Z]+(?![^(]*\\))/)[0]\r\n        c = this[handler]\r\n        if (c !== undefined && typeof c === 'function') {\r\n          h = ns.match(/\\(([^{}]+)\\)/)\r\n          handlerArgs = h ? h[1] : ''\r\n          argv = handlerArgs.split(',').filter(function (f) {\r\n            return f !== ''\r\n          })\r\n        \r\n          // if node is the rootNode for model, we wrap the eventListener and\r\n          // rebuild the arguments by appending id/className util rootNode.\r\n          if (node.hasChildNodes() && node.firstChild.nodeType !== DOCUMENT_ELEMENT_TYPE && node.firstChild.nodeValue.match(modelRaw)) {\r\n            rep = node.firstChild.nodeValue.replace(re, '$1').trim()\r\n            rep = rep.replace('model:', '')\r\n            model = this[rep]\r\n\r\n            function fn(e) {\r\n              e.stopPropagation()\r\n              if (e.target !== e.currentTarget) {\r\n                t = lookupParentNode(node, e.target)\r\n                c.apply(this, [model.list[getIndex(t)], e.target, e])\r\n              }\r\n            }\r\n            node.addEventListener(evtName, fn.bind(this), false)\r\n          } else {\r\n            node.addEventListener(evtName, c.bind.apply(c.bind(this), [node].concat(argv)), false)\r\n          }\r\n          if (!node.hasAttribute('evt-node')) {\r\n            node.setAttribute('evt-node', '')\r\n            if (node.hasAttribute('id')) {\r\n              p = this.__pristineFragment__.getElementById(node.id)\r\n              p.setAttribute('evt-node', '')\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n","import replaceHandleBars from './replaceHandleBars'\r\nimport replaceCommentBlock from './replaceCommentBlock'\r\nimport addEvent from './addEvent'\r\n\r\nconst DOCUMENT_ELEMENT_TYPE = 1\r\nconst DOCUMENT_COMMENT_TYPE = 8\r\nconst re = /{{([^{}]+)}}/g\r\n\r\nfunction templateParse (ctx, updateStateList, modelInstance, modelObject, conditional) {\r\n  \r\n  let currentNode\r\n  let fragment\r\n  let instance\r\n  let nodeAttributes\r\n  let i = 0\r\n  let a\r\n  let ns\r\n  let name\r\n\r\n  if (modelObject) {\r\n    instance = modelInstance\r\n  } else if (conditional) {\r\n    instance = conditional.firstChild\r\n  } else {\r\n    fragment = ctx.base\r\n    instance = fragment.firstChild\r\n  }\r\n\r\n  let ins = modelObject || ctx\r\n\r\n  const inspectAttributes = node => {\r\n    nodeAttributes = node.attributes\r\n    for (i = nodeAttributes.length; i--;) {\r\n      a = nodeAttributes[i]\r\n      name = a.localName\r\n      ns = a.nodeValue\r\n      if (re.test(name)) {\r\n        node.removeAttribute(name)\r\n        name = replaceHandleBars(name, node, ins, null, null, true)\r\n        node.setAttribute(name, ns)\r\n      } else if (re.test(ns)) {\r\n        ns = replaceHandleBars(ns, node, ins, null, null, true)\r\n        if (ns === '') {\r\n          node.removeAttribute(name)\r\n        } else {\r\n          if (name === 'checked') {\r\n            node.setAttribute(name, '')\r\n          } else {\r\n            node.setAttribute(name, ns)\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  const check = node => {\r\n    while (node) {\r\n      currentNode = node\r\n      if (currentNode.nodeType === DOCUMENT_ELEMENT_TYPE) {\r\n        if (currentNode.hasAttributes()) {\r\n          addEvent.call(ctx, currentNode)\r\n          inspectAttributes(currentNode)\r\n        }\r\n        check(currentNode.firstChild)\r\n      } else if (currentNode.nodeValue.match(re)) {\r\n        if (currentNode.nodeType === DOCUMENT_COMMENT_TYPE) {\r\n          replaceCommentBlock.call(ctx, currentNode.nodeValue, currentNode, ins, updateStateList, templateParse)\r\n        } else {\r\n          replaceHandleBars.call(ctx, currentNode.nodeValue, currentNode, ins, updateStateList, templateParse)\r\n        }\r\n      }\r\n      node = node.nextSibling\r\n    }\r\n  }\r\n\r\n  check(instance)\r\n}\r\n\r\nexport default templateParse\r\n","'use strict'\nvar parser = window.DOMParser && new window.DOMParser()\nvar documentRootName = 'HTML'\nvar supportsHTMLType = false\nvar supportsInnerHTML = false\nvar htmlType = 'text/html'\nvar xhtmlType = 'application/xhtml+xml'\nvar testClass = 'A'\nvar testCode = '<wbr class=\"' + testClass + '\"/>'\n\ntry {\n  // Check if browser supports text/html DOMParser\n  var parsed = parser.parseFromString(testCode, htmlType).body.firstChild\n  // Some browsers (iOS 9 and Safari 9) lowercase classes for parsed elements\n  // but only when appending to DOM, so use innerHTML instead\n  var d = document.createElement('div')\n  d.appendChild(parsed)\n  if (d.firstChild.classList[0] !== testClass) throw new Error()\n  supportsHTMLType = true\n} catch (e) {}\n\nvar mockDoc = document.implementation.createHTMLDocument('')\nvar mockHTML = mockDoc.documentElement\nvar mockBody = mockDoc.body\ntry {\n  // Check if browser supports documentElement.innerHTML\n  mockHTML.innerHTML += ''\n  supportsInnerHTML = true\n} catch (e) {\n  // Check if browser supports xhtml parsing.\n  parser.parseFromString(testCode, xhtmlType)\n  var bodyReg = /(<body[^>]*>)([\\s\\S]*)<\\/body>/\n}\n\nfunction DOMParserParse (markup, rootName) {\n  var doc = parser.parseFromString(markup, htmlType)\n  // Patch for iOS UIWebView not always returning doc.body synchronously\n  if (!doc.body) { return fallbackParse(markup, rootName) }\n\n  return rootName === documentRootName\n    ? doc.documentElement\n    : doc.body.firstChild\n}\n\nfunction fallbackParse (markup, rootName) {\n  // Fallback to innerHTML for other older browsers.\n  if (rootName === documentRootName) {\n    if (supportsInnerHTML) {\n      mockHTML.innerHTML = markup\n      return mockHTML\n    } else {\n      // IE9 does not support innerhtml at root level.\n      // We get around this by parsing everything except the body as xhtml.\n      var bodyMatch = markup.match(bodyReg)\n      if (bodyMatch) {\n        var bodyContent = bodyMatch[2]\n        var startBody = bodyMatch.index + bodyMatch[1].length\n        var endBody = startBody + bodyContent.length\n        markup = markup.slice(0, startBody) + markup.slice(endBody)\n        mockBody.innerHTML = bodyContent\n      }\n\n      var doc = parser.parseFromString(markup, xhtmlType)\n      var body = doc.body\n      while (mockBody.firstChild) body.appendChild(mockBody.firstChild)\n      return doc.documentElement\n    }\n  } else {\n    mockBody.innerHTML = markup\n    return mockBody.firstChild\n  }\n}\n\n/**\n * Returns the results of a DOMParser as an HTMLElement.\n * (Shims for older browsers).\n */\nmodule.exports = supportsHTMLType\n  ? DOMParserParse\n  : fallbackParse\n","'use strict'\n\nsetDOM.KEY = 'data-key'\nsetDOM.IGNORE = 'data-ignore'\nsetDOM.CHECKSUM = 'data-checksum'\nvar parseHTML = require('./parse-html')\nvar KEY_PREFIX = '_set-dom-'\nvar NODE_MOUNTED = KEY_PREFIX + 'mounted'\nvar ELEMENT_TYPE = 1\nvar DOCUMENT_TYPE = 9\nvar DOCUMENT_FRAGMENT_TYPE = 11\n\n// Expose api.\nmodule.exports = setDOM\n\n/**\n * @description\n * Updates existing dom to match a new dom.\n *\n * @param {Node} oldNode - The html entity to update.\n * @param {String|Node} newNode - The updated html(entity).\n */\nfunction setDOM (oldNode, newNode) {\n  // Ensure a realish dom node is provided.\n  assert(oldNode && oldNode.nodeType, 'You must provide a valid node to update.')\n\n  // Alias document element with document.\n  if (oldNode.nodeType === DOCUMENT_TYPE) oldNode = oldNode.documentElement\n\n  // Document Fragments don't have attributes, so no need to look at checksums, ignored, attributes, or node replacement.\n  if (newNode.nodeType === DOCUMENT_FRAGMENT_TYPE) {\n    // Simply update all children (and subchildren).\n    setChildNodes(oldNode, newNode)\n  } else {\n    // Otherwise we diff the entire old node.\n    setNode(oldNode, typeof newNode === 'string'\n      // If a string was provided we will parse it as dom.\n      ? parseHTML(newNode, oldNode.nodeName)\n      : newNode\n    )\n  }\n\n  // Trigger mount events on initial set.\n  if (!oldNode[NODE_MOUNTED]) {\n    oldNode[NODE_MOUNTED] = true\n    mount(oldNode)\n  }\n}\n\n/**\n * @private\n * @description\n * Updates a specific htmlNode and does whatever it takes to convert it to another one.\n *\n * @param {Node} oldNode - The previous HTMLNode.\n * @param {Node} newNode - The updated HTMLNode.\n */\nfunction setNode (oldNode, newNode) {\n  if (oldNode.nodeType === newNode.nodeType) {\n    // Handle regular element node updates.\n    if (oldNode.nodeType === ELEMENT_TYPE) {\n      // Checks if nodes are equal before diffing.\n      if (isEqualNode(oldNode, newNode)) return\n\n      // Update all children (and subchildren).\n      setChildNodes(oldNode, newNode)\n\n      // Update the elements attributes / tagName.\n      if (oldNode.nodeName === newNode.nodeName) {\n        // If we have the same nodename then we can directly update the attributes.\n        setAttributes(oldNode.attributes, newNode.attributes)\n      } else {\n        // Otherwise clone the new node to use as the existing node.\n        var newPrev = newNode.cloneNode()\n        // Copy over all existing children from the original node.\n        while (oldNode.firstChild) newPrev.appendChild(oldNode.firstChild)\n        // Replace the original node with the new one with the right tag.\n        oldNode.parentNode.replaceChild(newPrev, oldNode)\n      }\n    } else {\n      // Handle other types of node updates (text/comments/etc).\n      // If both are the same type of node we can update directly.\n      if (oldNode.nodeValue !== newNode.nodeValue) {\n        oldNode.nodeValue = newNode.nodeValue\n      }\n    }\n  } else {\n    // we have to replace the node.\n    oldNode.parentNode.replaceChild(newNode, dismount(oldNode))\n    mount(newNode)\n  }\n}\n\n/**\n * @private\n * @description\n * Utility that will update one list of attributes to match another.\n *\n * @param {NamedNodeMap} oldAttributes - The previous attributes.\n * @param {NamedNodeMap} newAttributes - The updated attributes.\n */\nfunction setAttributes (oldAttributes, newAttributes) {\n  var i, a, b, ns, name\n\n  // Remove old attributes.\n  for (i = oldAttributes.length; i--;) {\n    a = oldAttributes[i]\n    ns = a.namespaceURI\n    name = a.localName\n    b = newAttributes.getNamedItemNS(ns, name)\n    if (!b) oldAttributes.removeNamedItemNS(ns, name)\n  }\n\n  // Set new attributes.\n  for (i = newAttributes.length; i--;) {\n    a = newAttributes[i]\n    ns = a.namespaceURI\n    name = a.localName\n    b = oldAttributes.getNamedItemNS(ns, name)\n    if (!b) {\n      // Add a new attribute.\n      newAttributes.removeNamedItemNS(ns, name)\n      oldAttributes.setNamedItemNS(a)\n    } else if (b.value !== a.value) {\n      // Update existing attribute.\n      b.value = a.value\n    }\n  }\n}\n\n/**\n * @private\n * @description\n * Utility that will nodes childern to match another nodes children.\n *\n * @param {Node} oldParent - The existing parent node.\n * @param {Node} newParent - The new parent node.\n */\nfunction setChildNodes (oldParent, newParent) {\n  var checkOld, oldKey, checkNew, newKey, foundNode, keyedNodes\n  var oldNode = oldParent.firstChild\n  var newNode = newParent.firstChild\n  var extra = 0\n\n  // Extract keyed nodes from previous children and keep track of total count.\n  while (oldNode) {\n    extra++\n    checkOld = oldNode\n    oldKey = getKey(checkOld)\n    oldNode = oldNode.nextSibling\n\n    if (oldKey) {\n      if (!keyedNodes) keyedNodes = {}\n      keyedNodes[oldKey] = checkOld\n    }\n  }\n\n  // Loop over new nodes and perform updates.\n  oldNode = oldParent.firstChild\n  while (newNode) {\n    extra--\n    checkNew = newNode\n    newNode = newNode.nextSibling\n\n    if (keyedNodes && (newKey = getKey(checkNew)) && (foundNode = keyedNodes[newKey])) {\n      delete keyedNodes[newKey]\n      // If we have a key and it existed before we move the previous node to the new position if needed and diff it.\n      if (foundNode !== oldNode) {\n        oldParent.insertBefore(foundNode, oldNode)\n      } else {\n        oldNode = oldNode.nextSibling\n      }\n\n      setNode(foundNode, checkNew)\n    } else if (oldNode) {\n      checkOld = oldNode\n      oldNode = oldNode.nextSibling\n      if (getKey(checkOld)) {\n        // If the old child had a key we skip over it until the end.\n        oldParent.insertBefore(checkNew, checkOld)\n        mount(checkNew)\n      } else {\n        // Otherwise we diff the two non-keyed nodes.\n        setNode(checkOld, checkNew)\n      }\n    } else {\n      // Finally if there was no old node we add the new node.\n      oldParent.appendChild(checkNew)\n      mount(checkNew)\n    }\n  }\n\n  // Remove old keyed nodes.\n  for (oldKey in keyedNodes) {\n    extra--\n    oldParent.removeChild(dismount(keyedNodes[oldKey]))\n  }\n\n  // If we have any remaining unkeyed nodes remove them from the end.\n  while (--extra >= 0) {\n    oldParent.removeChild(dismount(oldParent.lastChild))\n  }\n}\n\n/**\n * @private\n * @description\n * Utility to try to pull a key out of an element.\n * Uses 'data-key' if possible and falls back to 'id'.\n *\n * @param {Node} node - The node to get the key for.\n * @return {string|void}\n */\nfunction getKey (node) {\n  if (node.nodeType !== ELEMENT_TYPE) return\n  var key = node.getAttribute(setDOM.KEY) || node.id\n  if (key) return KEY_PREFIX + key\n}\n\n/**\n * Checks if nodes are equal using the following by checking if\n * they are both ignored, have the same checksum, or have the\n * same contents.\n *\n * @param {Node} a - One of the nodes to compare.\n * @param {Node} b - Another node to compare.\n */\nfunction isEqualNode (a, b) {\n  return (\n    // Check if both nodes are ignored.\n    (isIgnored(a) && isIgnored(b)) ||\n    // Check if both nodes have the same checksum.\n    (getCheckSum(a) === getCheckSum(b)) ||\n    // Fall back to native isEqualNode check.\n    a.isEqualNode(b)\n  )\n}\n\n/**\n * @private\n * @description\n * Utility to try to pull a checksum attribute from an element.\n * Uses 'data-checksum' or user specified checksum property.\n *\n * @param {Node} node - The node to get the checksum for.\n * @return {string|NaN}\n */\nfunction getCheckSum (node) {\n  return node.getAttribute(setDOM.CHECKSUM) || NaN\n}\n\n/**\n * @private\n * @description\n * Utility to try to check if an element should be ignored by the algorithm.\n * Uses 'data-ignore' or user specified ignore property.\n *\n * @param {Node} node - The node to check if it should be ignored.\n * @return {boolean}\n */\nfunction isIgnored (node) {\n  return node.getAttribute(setDOM.IGNORE) != null\n}\n\n/**\n * Dispatches a mount event for the given node and children.\n *\n * @param {Node} node - the node to mount.\n * @return {node}\n */\nfunction mount (node) {\n  return dispatch(node, 'mount')\n}\n\n/**\n * Dispatches a dismount event for the given node and children.\n *\n * @param {Node} node - the node to dismount.\n * @return {node}\n */\nfunction dismount (node) {\n  return dispatch(node, 'dismount')\n}\n\n/**\n * Recursively trigger an event for a node and it's children.\n * Only emits events for keyed nodes.\n *\n * @param {Node} node - the initial node.\n * @return {Node}\n */\nfunction dispatch (node, type) {\n  // Trigger event for this element if it has a key.\n  if (getKey(node)) {\n    var ev = document.createEvent('Event')\n    var prop = { value: node }\n    ev.initEvent(type, false, false)\n    Object.defineProperty(ev, 'target', prop)\n    Object.defineProperty(ev, 'srcElement', prop)\n    node.dispatchEvent(ev)\n  }\n\n  // Dispatch to all children.\n  var child = node.firstChild\n  while (child) child = dispatch(child, type).nextSibling\n  return node\n}\n\n/**\n * @private\n * @description\n * Confirm that a value is truthy, throws an error message otherwise.\n *\n * @param {*} val - the val to test.\n * @param {string} msg - the error message on failure.\n * @throws {Error}\n */\nfunction assert (val, msg) {\n  if (!val) throw new Error('set-dom: ' + msg)\n}\n","import templateParse from './templateParse/index'\r\nimport strInterpreter from './strInterpreter'\r\nimport morph from 'set-dom'\r\nimport { getId } from '../../utils'\r\n\r\nmorph.KEY = 'kdata-id'\r\n\r\nconst DELAY = 1\r\nlet el\r\n\r\nconst morpher = function () {\r\n  if(this.el === 'todo-list'){\r\n    // console.log('b4 render', new Date() - window.t)\r\n  }\r\n  el = getId(this.el)\r\n  genElement.call(this)\r\n  if(this.el === 'todo-list'){\r\n    // console.log('after render', new Date() - window.t)\r\n  }\r\n  if (el) {\r\n    this.IS_STUB ? morph(el, this.base.firstChild) : morph(el, this.base)\r\n  }\r\n  // exec life-cycle componentDidUpdate\r\n  if (this.componentDidUpdate && typeof this.componentDidUpdate === 'function') {\r\n    this.componentDidUpdate()\r\n  }\r\n}\r\n\r\nlet timer = {}\r\nconst updateContext = function (fn, delay) {\r\n  // if(this.el === 'todo-list'){\r\n  //   window.t = new Date()\r\n  // }\r\n  timer[this.ID] = timer[this.ID] || null\r\n  clearTimeout(timer[this.ID])\r\n  timer[this.ID] = setTimeout(() => fn.call(this), delay)\r\n}\r\n\r\nconst nextState = function (i) {\r\n  let state\r\n  let value\r\n  if (i < stateList.length) {\r\n    state = stateList[i]\r\n    value = this[state]\r\n\r\n    // if value is undefined, likely has object notation we convert it to array\r\n    if (value === undefined) value = strInterpreter(state)\r\n\r\n    if (value && Array.isArray(value)) {\r\n      // using split object notation as base for state update\r\n      let inVal = this[value[0]][value[1]]\r\n      Object.defineProperty(this[value[0]], value[1], {\r\n        enumerable: false,\r\n        configurable: true,\r\n        get: function () {\r\n          return inVal\r\n        },\r\n        set: function (val) {\r\n          inVal = val\r\n          updateContext.call(this, morpher, DELAY)\r\n        }\r\n      })\r\n    } else {\r\n      // handle parent state update if the state is not an object\r\n      Object.defineProperty(this, state, {\r\n        enumerable: false,\r\n        configurable: true,\r\n        get: function () {\r\n          return value\r\n        },\r\n        set: function (val) {\r\n          value = val\r\n          updateContext.call(this, morpher, DELAY)\r\n        }\r\n      })\r\n    }\r\n    i++\r\n    nextState.call(this, i)\r\n  }\r\n}\r\n\r\nconst setState = function () {\r\n  nextState.call(this, 0)\r\n}\r\n\r\nlet stateList = []\r\n\r\nconst clearState = () => {\r\n  stateList = []\r\n}\r\n\r\nconst addState = state => {\r\n  if (stateList.indexOf(state) === -1) { stateList = stateList.concat(state) }\r\n}\r\n\r\nconst genElement = function () {\r\n  this.base = this.__pristineFragment__.cloneNode(true)\r\n  templateParse(this, addState)\r\n}\r\n\r\nexport {\r\n  genElement,\r\n  addState,\r\n  setState,\r\n  clearState,\r\n  updateContext,\r\n  morpher\r\n}\r\n","import templateParse from './templateParse/index'\r\nimport { setState, addState } from './genElement'\r\nimport { getId, assert } from '../../utils'\r\n\r\nconst DOCUMENT_ELEMENT_TYPE = 1\r\n\r\nexport default function (stub) {\r\n  templateParse(this, addState)\r\n  const el = stub || getId(this.el)\r\n  if (el) {\r\n    if (el.nodeType === DOCUMENT_ELEMENT_TYPE) {\r\n      el.setAttribute('data-ignore', '')\r\n    } else {\r\n      assert(this.base.childNodes.length === 1, 'Sub-component should only has a single rootNode.')\r\n      !this.base.firstChild.hasAttribute('data-ignore') && this.base.firstChild.setAttribute('data-ignore', '')\r\n    }\r\n    // listen to state changes\r\n    setState.call(this)\r\n\r\n    // mount fragment to DOM\r\n    if (!stub) {\r\n      el.appendChild(this.base)\r\n    }\r\n\r\n    // since component already rendered, trigger its life-cycle method\r\n    if (this.componentDidMount && typeof this.componentDidMount === 'function') {\r\n      this.componentDidMount()\r\n    }\r\n  } else {\r\n    assert(false, 'No element with id: \"' + this.el + '\" exist.')\r\n  }\r\n}\r\n","import { clearState } from '../components/genElement'\r\n\r\nconst DOCUMENT_FRAGMENT_TYPE = 11\r\nconst DOCUMENT_TEXT_TYPE = 3\r\nconst DOCUMENT_ELEMENT_TYPE = 1\r\n/**\r\n * @private\r\n * @description\r\n * Mount an instance of string or html elements\r\n *\r\n * @param {String|Object} instance - the html/string \r\n */\r\nexport default function(instance) {\r\n  let base\r\n  let tempDiv\r\n  let frag = document.createDocumentFragment()\r\n  // Before we begin to parse an instance, do a run-down checks\r\n  // to clean up back-tick string which usually has line spacing.\r\n  if (typeof instance === 'string') {\r\n    base = instance.trim().replace(/\\s+/g, ' ')\r\n    tempDiv = document.createElement('div')\r\n    tempDiv.innerHTML = base\r\n    while (tempDiv.firstChild) {\r\n      frag.appendChild(tempDiv.firstChild)\r\n    }\r\n  // If instance is a html element process as html entities\r\n  } else if (typeof instance === 'object' && instance['nodeType']) {\r\n    if (instance['nodeType'] === DOCUMENT_ELEMENT_TYPE) {\r\n      frag.appendChild(instance)\r\n    } else if (instance['nodeType'] === DOCUMENT_FRAGMENT_TYPE) {\r\n      frag = instance\r\n    } else if (instance['nodeType'] === DOCUMENT_TEXT_TYPE) {\r\n      frag.appendChild(instance)\r\n    } else {\r\n      assert(false, 'Unable to parse instance, unknown type.')\r\n    }\r\n  } else {\r\n    assert(false, 'Parameter is not a string or a html element.')\r\n  }\r\n  // we store the pristine instance in __pristineFragment__\r\n  this.__pristineFragment__ = frag.cloneNode(true)\r\n  this.base = frag\r\n\r\n  // cleanup states on mount\r\n  clearState()\r\n  return this\r\n}","/**\r\n * Keetjs v4.0.0 Alpha release: https://github.com/keetjs/keet.js\r\n * Minimali4.0.0ew layer for the web\r\n *\r\n * <<<<<<<<<<<<<<<<<<<<<<<<<<<<<< Keetjs >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>\r\n *\r\n * Copyright 2018, Shahrul Nizam Selamat\r\n * Released under the MIT License.\r\n */\r\n\r\nimport parseStr from './src/components/parseStr'\r\nimport { updateContext, morpher } from './src/components/genElement'\r\nimport { getId, genId, assert } from './utils'\r\nimport mount from './src/base/mount'\r\n\r\nwindow.l= console.log.bind(console)\r\n\r\n/**\r\n * @description\r\n * The main constructor of Keet\r\n *\r\n * Basic Usage :-\r\n *\r\n *    const App extends Keet {}\r\n *    const app = new App()\r\n *    app.mount('hello world').link('app')\r\n *\r\n */\r\nclass Keet {\r\n\r\n  constructor () {\r\n    this.ID = Keet.indentity\r\n  }\r\n\r\n  // generate ID for the component\r\n  static get indentity(){\r\n    return genId()\r\n  }\r\n\r\n  mount (instance) {\r\n    return mount.call(this, instance)\r\n  }\r\n\r\n  link (id) {\r\n    // The target DOM where the rendering will took place.\r\n    if (!id) assert(id, 'No id is given as parameter.')\r\n    this.el = id\r\n    this.render()\r\n    return this\r\n  }\r\n\r\n  render (stub) {\r\n    // life-cycle method before rendering the component\r\n    if (this.componentWillMount && typeof this.componentWillMount === 'function') {\r\n      this.componentWillMount()\r\n    }\r\n\r\n    // Render this component to the target DOM\r\n    if (stub) {\r\n      this.IS_STUB = true\r\n    }\r\n    parseStr.call(this, stub)\r\n  }\r\n\r\n  callBatchPoolUpdate () {\r\n    // force component to update, if any state / non-state\r\n    // value changed DOM diffing will occur\r\n    updateContext.call(this, morpher, 1)\r\n  }\r\n\r\n  subscribe (fn) {\r\n    this.exec = fn\r\n  }\r\n\r\n  inform (model) {\r\n    this.exec && typeof this.exec === 'function' && this.exec(model)\r\n  }\r\n\r\n}\r\n\r\nexport default Keet\r\n","const store = function(namespace, data) {\r\n  if (arguments.length > 1) {\r\n    return localStorage.setItem(namespace, JSON.stringify(data))\r\n  } else {\r\n    var store = localStorage.getItem(namespace)\r\n    return store && JSON.parse(store) || []\r\n  }\r\n}\r\n\r\nconst genId = function() {\r\n  return (Math.round(Math.random() * 0x1*1e12)).toString(32)\r\n}\r\n\r\nconst camelCase = function(s) {\r\n  return s.charAt(0).toUpperCase() + s.slice(1)\r\n}\r\n\r\nconst html = function (literalSections, ...substs) {\r\n  // Use raw literal sections: we donâ€™t want\r\n  // backslashes (\\n etc.) to be interpreted\r\n  let raw = literalSections.raw;\r\n\r\n  let result = '';\r\n\r\n  substs.forEach((subst, i) => {\r\n      // Retrieve the literal section preceding\r\n      // the current substitution\r\n      let lit = raw[i];\r\n\r\n      // In the example, map() returns an array:\r\n      // If substitution is an array (and not a string),\r\n      // we turn it into a string\r\n      if (Array.isArray(subst)) {\r\n          subst = subst.join('');\r\n      }\r\n\r\n      // If the substitution is preceded by a dollar sign,\r\n      // we escape special characters in it\r\n      if (lit.endsWith('$')) {\r\n          subst = htmlEscape(subst);\r\n          lit = lit.slice(0, -1);\r\n      }\r\n      result += lit;\r\n      result += subst;\r\n  });\r\n  // Take care of last literal section\r\n  // (Never fails, because an empty template string\r\n  // produces one literal section, an empty string)\r\n  result += raw[raw.length-1]; // (A)\r\n\r\n  return result;\r\n}\r\n\r\nexport {\r\n  html as default,\r\n  genId,\r\n  store,\r\n  camelCase\r\n}","import { camelCase } from './util'\r\nimport { createModel } from '../../keet/utils'\r\n\r\nclass CreateFilterModel extends createModel {\r\n  switch(hash, obj){\r\n    this.list = this.list.map(filter =>\r\n      filter.hash === hash ? ({ ...filter, ...obj}) : ({ ...filter, ...{ selected: false }})\r\n    )\r\n  }\r\n}\r\n\r\nconst filterModel = new CreateFilterModel()\r\n\r\nArray.from(['all', 'active', 'completed']).map(page =>\r\n\tfilterModel.add({\r\n    hash: `#/${page}`,\r\n    name: camelCase(page),\r\n    selected: false\r\n  })\r\n)\r\n\r\nexport default filterModel","import Keet from '../../keet'\r\nimport { html } from '../../keet/utils'\r\nimport filterModel from './filter-model'\r\n\r\n\r\nclass App extends Keet {\r\n  el = 'filters'\r\n  filterModel = filterModel\r\n  componentWillMount() {\r\n    this.filterModel.subscribe(model => this.callBatchPoolUpdate())\r\n    if(window.location.hash == '') {\r\n      window.history.pushState({}, null, '#/all')\r\n    }\r\n  }\r\n  componentDidMount(){\r\n    this.updateUrl(window.location.hash)\r\n    window.onpopstate = () => this.updateUrl(window.location.hash)\r\n  }\r\n  updateUrl(hash) {\r\n    this.filterModel.switch(hash, { selected: true })\r\n  }\r\n}\r\n\r\nconst filterApp = new App()\r\n\r\nlet vmodel = html`\r\n\t<ul id=\"filters\" class=\"filters\">\r\n\t\t<!-- {{model:filterModel}} -->\r\n\t\t<li id=\"{{name}}\" k-click=\"updateUrl({{hash}})\"><a class=\"{{selected?selected:''}}\" href=\"{{hash}}\">{{name}}</a></li>\r\n\t\t<!-- {{/model:filterModel}} -->\r\n\t</ul>\r\n`\r\n\r\nfilterApp.mount(vmodel)\r\n\r\nexport default filterApp","import Keet from '../../keet'\r\nimport { createModel } from '../../keet/utils'\r\n\r\nclass CreateModel extends createModel {\r\n  clearCompleted() {\r\n    this.list = this.list.filter(todo => !todo.completed)\r\n  } \r\n}\r\n\r\nconst todoModel = new CreateModel()\r\n\r\nexport default todoModel\r\n","import Keet from '../../keet'\r\nimport { html } from '../../keet/utils'\r\nimport todoModel from './todo-model'\r\nlet x\r\nclass App extends Keet {\r\n  el = 'todo-list'\r\n  todoModel = todoModel\r\n  constructor() {\r\n    super()\r\n    this.todoModel.subscribe(model => {\r\n      this.inform(model)\r\n    })\r\n  }\r\n  addTodo(newTodo){\r\n    this.todoModel.add(newTodo)\r\n  }\r\n  evtTodo(obj, target){\r\n    if(!x){\r\n      x = true\r\n      window.t = new Date()\r\n    }\r\n    // console.log(obj)\r\n    if(target.className === 'toggle')\r\n      this.todoModel.update({ ...obj,  completed: !obj.completed })\r\n    else if(target.className === 'destroy')  \r\n      this.todoModel.destroy(obj)\r\n  }\r\n  // toggleTodo(obj) {\r\n  //   console.log(obj)\r\n  //   this.todoModel.update({ ...obj,  completed: !obj.completed })\r\n  // }\r\n  // toggleTodo(id, completed) {\r\n  //   this.todoModel.update( 'id', { id, completed })\r\n  // }\r\n  // todoDestroy(obj) {\r\n  //   this.todoModel.destroy(obj)\r\n  // }\r\n  editMode(){\r\n    \r\n  }\r\n}\r\n\r\nconst todoApp = new App()\r\n\r\nlet vmodel = html`\r\n  <ul id=\"todo-list\" class=\"todo-list\" k-click=\"evtTodo()\">\r\n    <!-- {{model:todoModel}} -->\r\n      <li class=\"{{completed?completed:''}}\">\r\n        <div class=\"view\">\r\n          <input class=\"toggle\" type=\"checkbox\" checked=\"{{completed?checked:''}}\">\r\n          <label>{{title}}</label>\r\n          <button class=\"destroy\"></button>\r\n        </div>\r\n        <input class=\"edit\" value=\"{{title}}\">\r\n      </li>\r\n    <!-- {{/model:todoModel}} -->\r\n  </ul>\r\n`\r\n\r\ntodoApp.mount(vmodel)\r\n\r\nexport default todoApp","import Keet from '../../keet'\r\nimport { html } from '../../keet/utils'\r\nimport { genId } from './util'\r\nimport filterApp  from './filter'\r\nimport todoApp from './todo'\r\n\r\nclass App extends Keet {\r\n  todoApp = todoApp\r\n  filter = filterApp\r\n  isChecked = false\r\n  count = 0\r\n  plural = ''\r\n  clearToggle = false\r\n  todoState = false\r\n\r\n  componentWillMount() {\r\n    todoApp.subscribe(todos => {\r\n      let uncompleted = todos.filter(c => !c.completed)\r\n      let completed = todos.filter(c => c.completed)\r\n      this.clearToggle = completed.length ? true : false\r\n      this.todoState = todos.length ? true : false\r\n      this.plural = uncompleted.length === 1 ? '' : 's'\r\n      this.count = uncompleted.length\r\n      console.log(todos)\r\n    })\r\n  }\r\n\r\n  create (evt) {\r\n    if(evt.keyCode !== 13) return\r\n    evt.preventDefault()\r\n    let title = evt.target.value.trim()\r\n    if(title){\r\n      this.todoApp.addTodo({ title, completed: false })\r\n      evt.target.value = ''\r\n    }\r\n  }\r\n\r\n  completeAll(){\r\n    this.isChecked = !this.isChecked\r\n    // this.todoApp.updateAll(this.isChecked)\r\n  }\r\n\r\n  clearCompleted() {\r\n    this.todoApp.clearCompleted()\r\n  }\r\n  editMode(){\r\n\r\n  }\r\n}\r\n\r\nconst vmodel = html`\r\n  <section class=\"todoapp\">\r\n    <header id=\"header\">\r\n      <h1>todos</h1>\r\n      <input id=\"new-todo\" class=\"new-todo\" k-keydown=\"create()\" placeholder=\"What needs to be done?\" autofocus>\r\n    </header>\r\n    <!-- {{?todoState}} -->\r\n    <section class=\"main\">\r\n      <input id=\"toggle-all\" class=\"toggle-all\" type=\"checkbox\" checked=\"{{isChecked?checked:''}}\" k-click=\"completeAll()\">\r\n      <label for=\"toggle-all\">Mark all as complete</label>\r\n      <!-- {{component:todoApp}} -->\r\n    </section>\r\n    <footer class=\"footer\">\r\n      <span class=\"todo-count\">\r\n        <strong>{{count}}</strong> item{{plural}} left\r\n      </span>\r\n      <!-- {{component:filter}} -->\r\n      <!-- {{?clearToggle}} -->\r\n      <button id=\"clear-completed\" class=\"clear-completed\">Clear completed</button>\r\n      <!-- {{/clearToggle}} -->\r\n    </footer>\r\n    <!-- {{/todoState}} -->\r\n  </section>\r\n  <footer class=\"info\">\r\n    <p>Double-click to edit a todo</p>\r\n    <p>Created by <a href=\"https://github.com/syarul\">Shahrul Nizam Selamat</a></p>\r\n    <p>Part of <a href=\"http://todomvc.com\">TodoMVC</a></p>\r\n  </footer>`\r\n\r\nconst app = new App()\r\n\r\napp.mount(vmodel).link('todo')\r\n\r\n// console.log(app)"],"names":["test","str","input","match","t","split","condition","leftHand","rightHand","value","state","res","result","length","updateStateList","node","replace","withTo","nodeValue","re","ins","templateParse","isAttr","props","ln","rep","tnr","isObjectNotation","ternaryOps","call","strInterpreter","updateState","valAssign","undefined","genId","rd","Math","random","toString","minId","getId","document","getElementById","id","checkNodeAvailability","component","componentName","callback","notFound","ele","el","found","find","clearInterval","fail","setInterval","setTimeout","assert","val","msg","Error","html","args","literals","shift","substs","slice","raw","reduce","acc","lit","i","map","trim","join","notEqual","a","b","inform","model","exec","createModel","Object","defineProperty","enumerable","configurable","get","set","subscribe","fn","add","obj","list","concat","update","updateObj","destroy","destroyObj","filter","RegExp","tmpl","isTernary","len","string","arrProps","diff","fst","sec","some","predicate","attr","inr","range","createRange","cache","m","documentFragment","render","genModelTemplate","createContextualFragment","firstChild","setAttribute","tmplHandler","modelList","listClone","parentNode","updateOfNew","diffOfOld","pNode","equalLength","child","oldModel","p","nextSibling","cloneNode","outerHTML","remove","__pristineFragment__","childNodes","hasOwnProperty","hasAttribute","insertBefore","diffModel","pop","querySelector","replaceChild","lastChild","removeChild","JSON","parse","stringify","bind","conditionalNodesRawStart","conditionalNodesRawEnd","DOCUMENT_ELEMENT_TYPE","conditional","frag","createDocumentFragment","entryNode","currentNode","isGen","cNode","nodeType","appendChild","cacheInit","componentStr","c","ID","base","callBatchPoolUpdate","conditionalRe","conditionalRep","modelRep","genModelList","conditionalNodes","componentParse","modelRaw","lookUpEvtNode","lookupParentNode","rootNode","getAttribute","isEqualNode","nodeAttributes","ns","evtName","h","handlerArgs","argv","handler","name","getIndex","indexOf","attributes","localName","f","hasChildNodes","e","stopPropagation","target","currentTarget","apply","addEventListener","DOCUMENT_COMMENT_TYPE","ctx","modelInstance","modelObject","fragment","instance","inspectAttributes","removeAttribute","replaceHandleBars","check","hasAttributes","addEvent","replaceCommentBlock","parser","window","DOMParser","documentRootName","supportsHTMLType","supportsInnerHTML","htmlType","xhtmlType","testClass","testCode","parsed","parseFromString","body","d","createElement","classList","mockDoc","implementation","createHTMLDocument","mockHTML","documentElement","mockBody","innerHTML","bodyReg","DOMParserParse","markup","rootName","doc","fallbackParse","bodyMatch","bodyContent","startBody","index","endBody","module","setDOM","KEY","IGNORE","CHECKSUM","KEY_PREFIX","NODE_MOUNTED","ELEMENT_TYPE","DOCUMENT_TYPE","DOCUMENT_FRAGMENT_TYPE","oldNode","newNode","parseHTML","nodeName","setNode","newPrev","dismount","setAttributes","oldAttributes","newAttributes","namespaceURI","getNamedItemNS","removeNamedItemNS","setNamedItemNS","setChildNodes","oldParent","newParent","checkOld","oldKey","checkNew","newKey","foundNode","keyedNodes","extra","getKey","key","isIgnored","getCheckSum","NaN","mount","dispatch","type","ev","createEvent","prop","initEvent","dispatchEvent","morph","DELAY","morpher","genElement","IS_STUB","componentDidUpdate","timer","updateContext","delay","clearTimeout","nextState","stateList","Array","isArray","inVal","setState","clearState","addState","stub","componentDidMount","DOCUMENT_TEXT_TYPE","tempDiv","l","console","log","Keet","indentity","link","componentWillMount","parseStr","camelCase","s","charAt","toUpperCase","CreateFilterModel","switch","hash","selected","filterModel","from","page","App","location","history","pushState","updateUrl","onpopstate","filterApp","vmodel","CreateModel","clearCompleted","todo","completed","todoModel","x","addTodo","newTodo","evtTodo","Date","className","editMode","todoApp","isChecked","count","plural","clearToggle","todoState","uncompleted","todos","create","evt","keyCode","preventDefault","title","completeAll","app"],"mappings":"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"}